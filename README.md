# Outline/Notion 風 ToDo アプリ

Outline/Notion 風のアウトライン UI をプレーン JavaScript で実装した Todo 管理 Web アプリケーション。  
インライン編集、任意位置挿入、ドラッグ＆ドロップ並び替え、1階層サブタスク、見出し、水平線をコンパクト表示で実現。

## ✨ 主な機能

### 📝 複数のアイテムタイプ
- **タスク**: チェックボックス + contenteditable。チェックで削除線＋淡色化。サブタスク（1階層）対応
- **見出し**: 太字・余白最小（15px フォント）
- **水平線**: 薄い区切り線

### 🎯 操作方法

#### インライン編集
- 行クリックで編集開始
- `Enter` で確定して次の行へ
- `Esc` でキャンセル
- 未確定で他行に移動時は自動確定

#### 並び替え
- 左端の `≡` ハンドルをドラッグ＆ドロップで並び替え
- 入れ子（サブタスク）に対応

#### 任意位置への挿入
- 行間にホバーすると「＋ 挿入バー」が表示
- クリックでその位置に新規タスクを即時挿入

#### 削除
- 行末の `×` ボタン（ホバーで表示）
- `Ctrl+Z` または `Cmd+Z` で直前の削除を復元

#### 階層操作
- `Tab`: サブタスク化（1階層のみ）
- `Shift+Tab`: 親レベルに戻す

### ⌨️ キーボードショートカット

#### スラッシュコマンド（簡易メニュー）
- `/t` → タスク
- `/h` → 見出し
- `/-` → 水平線

#### 編集・移動
- `Enter`: 下に新規行作成（同階層）
- `Shift+Enter`: 改行（将来対応予定）
- `↑` / `↓`: 上下行フォーカス移動
- `Tab` / `Shift+Tab`: サブタスク化／親へ戻す
- `Del` / `Backspace`: 空行時は削除
- `Ctrl+Z` / `Cmd+Z`: 削除の復元（1ステップ）

### 🎨 コンパクトな UI
- 行高: 30px
- 行間: ≤4px
- フォント: 13px（見出し 15px）
- サブタスク: 左インデント +20px、背景を僅かに淡色化
- 完了タスク: 削除線＋フェード
- ホバーで操作ボタン表示
- 1280×720 で 15-20 行以上がスクロール無しで表示可能

### ♿ アクセシビリティ
- `tabindex` / `aria` 属性対応
- キーボード操作完全対応
- スクリーンリーダー対応

### 💾 データ保存
- SQLite3 (PDO なし) に自動保存
- ページリロード後も内容、並び、階層、チェック状態を保持
- PHP ビルトインサーバーで動作

## 🚀 使い方

1. このフォルダで PHP ビルトインサーバーを起動:
   ```bash
   php -S localhost:8000
   ```

2. ブラウザで http://localhost:8000 を開く

3. 基本操作:
   - テキストを入力して `Enter` でタスク追加
   - `/h` で見出し、`/-` で水平線を作成
   - `≡` ハンドルをドラッグして順序変更
   - チェックボックスで完了/未完了を切り替え
   - `+` ボタンでサブタスク追加、または `Tab` キーでサブタスク化
   - 行間の `+` ボタンで任意位置に挿入
   - `×` ボタンで削除

## 🪟 付箋風の小ウィンドウ化（Windows）
- Chrome/Edge: 右上メニュー → 「保存と共有」→「ショートカットを作成」→「ウィンドウとして開く」

## 📁 構成
- `index.html` : UI 構造
- `style.css`  : コンパクトデザインのスタイル
- `script.js`  : フロントロジック（contenteditable、ドラッグ＆ドロップ、APIコール）
- `api.php`    : CRUD + 並び替え API（SQLite3, PDOなし）
- `fonts/`     : Noto Sans JP フォント
- `todo.db`    : 初回アクセス時に自動生成（.gitignore 対象）

## 💡 技術スタック
- **編集**: contenteditable とキーハンドリング
- **D&D**: ネイティブ HTML5 Drag and Drop API（ハンドルベース）
- **保存**: SQLite3（PDO なし）経由の API
- **データ構造**: `{ id, type, text, checked, parentId, order }`
  - `type`: 'task' | 'heading' | 'divider'
  - `parentId`: サブタスクの親 ID

## 🗄️ データベース
既存のデータベースは自動的にマイグレーションされます。
- `type`: アイテムの種類（task/heading/divider）
- `sort_order`: 並び順
- `parent_id`: サブタスクの親ID
